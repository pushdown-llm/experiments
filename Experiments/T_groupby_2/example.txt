
CREATE INDEX idx_orders_custkey_orderstatus 
 ON public.orders (o_custkey, o_orderstatus) INCLUDE (o_totalprice); 

CREATE MATERIALIZED VIEW mv_t_groupby_2 AS 
SELECT 
    o_custkey,
    o_orderstatus,
    SUM(o_totalprice) AS "Total price"
FROM public.orders
GROUP BY o_custkey, o_orderstatus
ORDER BY o_custkey, o_orderstatus;

SELECT * FROM mv_t_groupby_2;


////////// EXECUTION PLAN:

"GroupAggregate  (cost=0.43..58737.43 rows=150000 width=38)"
"  Group Key: o_custkey, o_orderstatus"
"  ->  Index Only Scan using idx_orders_custkey_orderstatus on orders  (cost=0.43..45612.43 rows=1500000 width=14)"

"Seq Scan on mv_t_groupby_2  (cost=0.00..2726.40 rows=144640 width=44)"